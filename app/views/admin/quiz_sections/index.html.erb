<% breadcrumb :admin_quiz_sections %>
<%= render "shared/breadcrumbs" %>

<h1 class="text-xl font-bold mb-4">Quiz Sections</h1>

<div class="mb-3 flex items-center justify-between gap-3">
  <%= link_to "＋ 新規作成", new_admin_quiz_section_path,
        class: "px-3 py-2 rounded bg-slate-900 text-white" %>

  <!-- ▼ 検索フォーム（Quiz.title / heading） -->
  <%= search_form_for @q, url: admin_quiz_sections_path, method: :get, html: { class: "flex gap-2" } do |f| %>
    <%= f.search_field :quiz_title_cont, placeholder: "Quizタイトル", class: "px-3 py-2 rounded ring-1 ring-slate-300 w-52" %>
    <%= f.search_field :heading_cont,    placeholder: "Section見出し", class: "px-3 py-2 rounded ring-1 ring-slate-300 w-56" %>
    <%= f.submit "検索", class: "px-3 py-2 rounded bg-slate-900 text-white" %>
    <% if params[:q].present? %>
      <%= link_to "クリア", admin_quiz_sections_path, class: "px-3 py-2 rounded ring-1 ring-slate-300" %>
    <% end %>
  <% end %>
</div>

<table class="w-full text-sm border rounded overflow-hidden">
  <thead class="bg-slate-50">
    <tr>
      <th class="p-2 text-right w-20">ID</th>
      <th class="p-2">Quiz</th>
      <th class="p-2">見出し</th>
      <th class="p-2 w-20">FREE</th>
      <th class="p-2 w-20">位置</th>
      <th class="p-2 w-40">更新</th>
      <th class="p-2 w-40"></th>
    </tr>
  </thead>
  <tbody>
    <% @sections.each do |s| %>
      <tr class="border-t">
        <td class="p-2 text-right font-mono"><%= s.id %></td>
        <td class="p-2"><%= s.quiz.title %></td>
        <td class="p-2"><%= s.heading %></td>
        <td class="p-2"><%= s.is_free ? "✔︎" : "" %></td>
        <td class="p-2"><%= s.position %></td>
        <td class="p-2"><%= l s.updated_at, format: :short %></td>
        <td class="p-2 text-right">
          <%= link_to "編集", edit_admin_quiz_section_path(s), class: "underline mr-3" %>
          <%= link_to "削除", admin_quiz_section_path(s),
                data: { turbo_method: :delete, turbo_confirm: "削除しますか？" },
                class: "underline text-red-600" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="mt-4"><%= paginate @sections if respond_to?(:paginate) %></div>
